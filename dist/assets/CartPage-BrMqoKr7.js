import{j as e,m as t,A as s}from"./ui-B2BnIfZo.js";import{r as a,b as i,u as r,L as l}from"./vendor-stn_h8-h.js";import{u as n,q as c,l as o,F as d,n as m,o as x,r as h,p as u}from"./index-d2POsy9f.js";import"./utils-Dnvf9ysO.js";const p=()=>{const{items:p,removeItem:j,updateQuantity:y,clearCart:b,getCartTotal:f,getItemCount:N}=n(),{isAuthenticated:g}=c(),[v,w]=a.useState(!0),[C,k]=a.useState(null),[S,T]=a.useState(!1),F=i(),q=r();new URLSearchParams(F.search).get("orderConfirmed");const[I,D]=a.useState(!1);a.useEffect((()=>{const e=setTimeout((()=>{w(!1)}),600);return()=>clearTimeout(e)}),[]);const A=f(),E=N(),L=0===E,P=L?0:7,O=A+P,Y=async(e,t)=>{if(t<1)return void z(e);await y(e,t)||u.error("Failed to update quantity. Item may be out of stock.")},z=async e=>{k(e);try{await j(e),u.success("Item removed from cart")}catch(t){u.error("Failed to remove item"),console.error("Error removing item:",t)}finally{k(null)}};return v||I?e.jsx("div",{className:"pt-24 pb-16 container",children:e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})})}):e.jsx("div",{className:"pt-24 pb-16",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsx(t.h1,{className:"text-3xl font-bold text-center lg:text-left",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:"Your Shopping Cart"}),e.jsxs(l,{to:"/products",className:"flex items-center text-primary-600 hover:underline",children:[e.jsx(o,{className:"mr-2"})," Continue Shopping"]})]}),L?e.jsxs(t.div,{className:"text-center py-16 bg-gray-50 rounded-lg",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[e.jsx(d,{className:"text-5xl text-gray-400 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Your cart is empty"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Looks like you haven't added any products to your cart yet."}),e.jsx(l,{to:"/products",className:"btn btn-primary",children:"Start Shopping"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx(t.div,{className:"lg:col-span-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Cart Items (",E,")"]}),e.jsx("button",{onClick:()=>T(!0),className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"Clear Cart"})]})}),e.jsx(s,{children:p.map((s=>e.jsxs(t.div,{className:"p-6 border-b border-gray-200 flex flex-col sm:flex-row gap-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,height:0,marginTop:0,marginBottom:0,padding:0},transition:{duration:.3},style:{opacity:C===s.id?.5:1},children:[e.jsx("div",{className:"w-full sm:w-24 h-24 bg-gray-100 rounded-md overflow-hidden",children:e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h3",{className:"font-medium text-lg mb-1",children:s.name}),e.jsxs("p",{className:"text-gray-600 text-sm mb-4",children:[s.price.toFixed(2)," TND"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>Y(s.id,s.quantity-1),className:"p-1 rounded-md hover:bg-gray-100",disabled:s.quantity<=1,children:e.jsx(m,{className:"text-gray-600"})}),e.jsx("span",{className:"w-12 text-center",children:s.quantity}),e.jsx("button",{onClick:()=>Y(s.id,s.quantity+1),className:"p-1 rounded-md hover:bg-gray-100",children:e.jsx(x,{className:"text-gray-600"})})]})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between",children:[e.jsxs("p",{className:"font-medium",children:[(s.price*s.quantity).toFixed(2)," TND"]}),e.jsx("button",{onClick:()=>z(s.id),className:"text-red-500 hover:text-red-700",disabled:C===s.id,children:e.jsx(h,{})})]})]},s.id)))})]})}),e.jsx(t.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Order Summary"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal"}),e.jsxs("span",{children:[A.toFixed(2)," TND"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping"}),e.jsxs("span",{children:[P.toFixed(2)," TND"]})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[O.toFixed(2)," TND"]})]})})]}),e.jsx("button",{onClick:()=>{if(!g)return u.error("Please log in to checkout"),void q("/login",{state:{from:"/checkout"}});sessionStorage.setItem("orderItems",JSON.stringify(p)),q("/checkout")},className:"btn btn-primary w-full mt-6",children:"Proceed to Checkout"})]})})]}),e.jsx(s,{children:S&&e.jsx(t.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(t.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Clear Cart?"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to remove all items from your cart?"}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>T(!1),className:"btn btn-outline",children:"Cancel"}),e.jsx("button",{onClick:async()=>{try{await b(),T(!1),u.success("Cart cleared")}catch(e){u.error("Failed to clear cart"),console.error("Error clearing cart:",e)}},className:"btn btn-danger",children:"Clear Cart"})]})]})})})]})})};export{p as default};
